<?
@include_once('../inc/top.php');
?>
        <!-- layer1 start -->
        <div class="layer1 first_layer chapters">
            <div class="inner">
                <div class="lyr1_box bg bg1"></div>
                <div class="lyr1_box bg bg2"></div>
                <div class="lyr1_box bg bg3"></div>
                <div class="lyr1_box bg bg4"></div>
            </div>
        </div>
        <!-- //layer1 end -->
        <div class="layer2 chapters">
            <div class="inner">
                <div class="lyr2_box bg bg1"></div>
                <div class="lyr2_box bg bg2">
                    <div class="text_wrap fs_def">
                        <p class="lyr2_year stitle2 t_center">2020</p>
                        <ul class="lyr2_list">
                            <li class="fs_def">
                                <p class="lyr2_month text2">03</p>
                                <p class="lyr2_con text">상무초밥 홈페이지 리뉴얼</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="lyr2_box bg bg3 t_white">
                    <div class="text_wrap fs_def">
                        <p class="lyr2_year stitle2 t_center">2019</p>
                        <ul class="lyr2_list">
                            <li class="fs_def">
                                <p class="lyr2_month text2">05</p>
                                <p class="lyr2_con text">상무초밥 천안점</p>
                            </li>
                            <li class="fs_def">
                                <p class="lyr2_month text2">05</p>
                                <p class="lyr2_con text">상무초밥 송도점</p>
                            </li>
                            <li class="fs_def">
                                <p class="lyr2_month text2">06</p>
                                <p class="lyr2_con text">상무초밥 전주송천점</p>
                            </li>
                            <li class="fs_def">
                                <p class="lyr2_month text2">07</p>
                                <p class="lyr2_con text">상무초밥 청주점</p>
                            </li>
                            <li class="fs_def">
                                <p class="lyr2_month text2">07</p>
                                <p class="lyr2_con text">상무초밥 산본점</p>
                            </li>
                            <li class="fs_def">
                                <p class="lyr2_month text2">11</p>
                                <p class="lyr2_con text">상무초밥 여수점</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="lyr2_box bg bg4">
                    <div class="text_wrap fs_def">
                        <p class="lyr2_year stitle2 t_center">2018</p>
                        <ul class="lyr2_list">
                            <li class="fs_def">
                                <p class="lyr2_month text2">03</p>
                                <p class="lyr2_con text">상무초밥 하당점</p>
                            </li>
                            <li class="fs_def">
                                <p class="lyr2_month text2">05</p>
                                <p class="lyr2_con text">상무초밥 논현점</p>
                            </li>
                            <li class="fs_def">
                                <p class="lyr2_month text2">08</p>
                                <p class="lyr2_con text">상무초밥 익산점</p>
                            </li>
                            <li class="fs_def">
                                <p class="lyr2_month text2">10</p>
                                <p class="lyr2_con text">상무초밥 둔산점</p>
                            </li>
                            <li class="fs_def">
                                <p class="lyr2_month text2">10</p>
                                <p class="lyr2_con text">상무초밥 전주도청점</p>
                            </li>
                            <li class="fs_def">
                                <p class="lyr2_month text2">11</p>
                                <p class="lyr2_con text">상무초밥 용봉점</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="lyr2_box bg bg5 t_white">
                    <div class="text_wrap fs_def">
                        <p class="lyr2_year stitle2 t_center">2017</p>
                        <ul class="lyr2_list">
                            <li class="fs_def">
                                <p class="lyr2_month text2">04</p>
                                <p class="lyr2_con text">상무초밥 첨단점</p>
                            </li>
                            <li class="fs_def">
                                <p class="lyr2_month text2">08</p>
                                <p class="lyr2_con text">상무초밥 순천점</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="lyr2_box bg bg6">
                    <div class="text_wrap fs_def">
                        <p class="lyr2_year stitle2 t_center">2016</p>
                        <ul class="lyr2_list">
                            <li class="fs_def">
                                <p class="lyr2_month text2">08</p>
                                <p class="lyr2_con text">상무초밥 주식회사</p>
                            </li>
                            <li class="fs_def">
                                <p class="lyr2_month text2">11</p>
                                <p class="lyr2_con text">상무초밥 봉선점 주식회사</p>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="layer3 chapters">
            <div class="lyr3_box bg inner">
                <p class="lyr3_ttl"><img src="<?=$root?>/img/page/com/lyr3_ttl.png" alt="" class="w100"></p>
                <p class="stitle2 t_center">참치, 생연어회 전문점</p>
                <p class="text t_center">너는 참치먹을때가 제일 예쁘다...</p>
                <div class="fs_def t_center">
                    <a href="#none" class="lyr3_link int_btn">인테리어 보기</a>
                    <a href="#none" class="lyr3_link menu_btn">메뉴판 보기</a>
                </div>
            </div>
        </div>
        <div class="layer4 chapters">
            <p class="lyrtitle t_center">오시는 길</p>
            <p class="text2 t_center">㈜에스앤피프렌차이즈</p>
            <div class="map inner bg" id="map_area"></div>
            <div class="lyr4_list">
                <!--<div class="fs_def">
                    <p class="lyr4_p1 text2">문의전화</p>
                    <p class="lyr4_p2 text2">062-375-9205</p>
                </div>-->
                <div class="fs_def">
                    <p class="lyr4_p1 text2">주소</p>
                    <p class="lyr4_p2 text3">광주광역시 서구 운천로 253, 404호 <br>(치평동,아이타워)</p>
                </div>
            </div>
        </div>
        <script src="<?=$root?>/js/com.js?<?=$time?>"></script>
<?
@include_once('../inc/bottom.php');
?>


<script>
<?
$markerImgPath = '/design/other/marker.png';
$markerImgSize = getImagesize(ROOT_INC.$markerImgPath);
?>

var marker = {
	src: '<?=$pc.$markerImgPath?>',
	offset: {x: <?=(int)$markerImgSize[0] / 2?>, y: <?=(int)$markerImgSize[1]?>},
	size: {x: <?=(int)$markerImgSize[0]?>, y: <?=(int)$markerImgSize[1]?>}
};
var placeInfo = {
	appkey: '<?=$settings_data['kakao_api_key'];?>',
	container: 'map_area',
	geocode: {lat: '35.1549681263917', lng: '126.854409490311'},
	scrollwheel: false,
	marker: marker
};

/**************************************************************************************************
 * KakaoMap | Kakao map api를 이용하여 지도를 출력합니다.
 *
 * @class KakaoMap
 * @constructor
 * @version 1.0
 *
 * @param {Object} placeInfo 옵션 객체
 *
 **************************************************************************************************/
(function($) {

    'use strict';

    window.KakaoMap = function(placeInfo) {

    	var _this = this;

    	var map,
    		mapContainer = document.getElementById(placeInfo.container),
    		mapOptions = {level: 4},
    		marker,
    		markerOptions,
            rv,
            resizeTimer = null;

        var opt = {
            mapTypeControl: true,
            zoomControl: true
        };

    	/*
    	 * KakaoMap class 초기화 함수
    	 *
    	 * @method initialize
    	 */
    	this.initialize = function() {
            if(typeof placeInfo.scrollwheel === 'boolean') mapOptions.scrollwheel = false;
            if(typeof placeInfo.level === 'number') mapOptions.level = placeInfo.level;
            if(typeof placeInfo.mapTypeControl === 'boolean') opt.mapTypeControl = placeInfo.mapTypeControl;
            if(typeof placeInfo.zoomControl === 'boolean') opt.zoomControl = placeInfo.zoomControl;
    		var src = '//dapi.kakao.com/v2/maps/sdk.js?autoload=false&libraries=services&appkey='+ placeInfo.appkey;
    		_this.cachedScript(src, function() {
    			_this.mapLoad();
    		});
    	};
		this.cachedScript = function( url, callback ) {
			// kakao에서 timestamp 제거 요청으로 인한 처리 20181030 yoonwoo1023
			var options = {
				dataType: "script",
				cache: true,
				url: url,
				success : callback
			};
			return jQuery.ajax( options );
		};
    	this.mapLoad = function() {
    		daum.maps.load(function() {
                var reg = /daumcdn|services\.js/g;
                for(var i=0, src, res; i<$('head > script').length; i++) {
                    if(typeof $('head > script').eq(i).attr('src') === 'undefined') continue;
                    src = $('head > script').eq(i).attr('src');
                    res = src.match(reg);
                    if(res !== null && res.length === 2) {
                        _this.cachedScript(src, function() {
                            if(typeof placeInfo.geocode === 'object') {
                				mapOptions.center = new daum.maps.LatLng(placeInfo.geocode.lat, placeInfo.geocode.lng);
                				_this.mapping();
                				if(typeof placeInfo.roadView === 'object') _this.roadView();
                			} else {
                				_this.geocoding(placeInfo.address, function() {
                					_this.mapping();
                					if(typeof placeInfo.roadView === 'object') _this.roadView();
                				});
                			}
                        });
                        break;
                    }
                }
    		});
    	};

    	/*
    	 * 주소를 경위도 좌표로 변환합니다.
    	 *
    	 * @method geocoding
    	 * @param {String} addr 주소
    	 * @param {Function} callback 콜백 함수
    	 */
    	this.geocoding = function(addr, callback) {
    		var geocoder = new daum.maps.services.Geocoder();
    		geocoder.addressSearch(addr, function(result, status) {
    			if(status === daum.maps.services.Status.OK) {
    				mapOptions.center = new daum.maps.LatLng(result[0].y, result[0].x);
    				callback();
    			}
    		});
    	};

    	/*
    	 * 지도를 출력합니다.
    	 *
    	 * @method mapping
    	 */
    	this.mapping = function() {
    		map = new daum.maps.Map(mapContainer, mapOptions);
    		this.addMarker();
    		this.addControl();
            this.addHandler();
    		if(typeof placeInfo.callback === 'function') placeInfo.callback();
    	};

    	/*
    	 * 마커를 표시합니다.
    	 *
    	 * @method addMarker
    	 */
    	this.addMarker = function() {
            markerOptions = {
    			position: mapOptions.center
    		};
    		if(typeof placeInfo.marker === 'object' && typeof placeInfo.marker.src === 'string') {
                markerOptions.image = new daum.maps.MarkerImage(
                    placeInfo.marker.src,
                    new daum.maps.Size(placeInfo.marker.size.x, placeInfo.marker.size.y),
                    {offset: new daum.maps.Point(placeInfo.marker.offset.x, placeInfo.marker.offset.y)}
                );
    		}
    		var marker = new daum.maps.Marker(markerOptions);
    		marker.setMap(map);
    	};

    	/*
    	 * 컨트롤을 올립니다.
    	 *
    	 * @method addControl
    	 */
    	this.addControl = function() {
            // if(opt.mapTypeControl === true) map.addControl(new daum.maps.MapTypeControl(), daum.maps.ControlPosition.TOPRIGHT);
    		if(opt.zoomControl === true) map.addControl(new daum.maps.ZoomControl(), daum.maps.ControlPosition.RIGHT);
    	};

    	/*
    	 * 로드뷰를 출력합니다.
    	 *
    	 * @method roadView
    	 */
    	this.roadView = function() {
    		var rvOptions = placeInfo.roadView;
    		rv = new daum.maps.Roadview(document.getElementById(rvOptions.container));
    		var rvClient = new daum.maps.RoadviewClient();

    		rvClient.getNearestPanoId(mapOptions.center, 50, function(panoId) {
    			rv.setPanoId(panoId, mapOptions.center);
    		});
    	};

        this.addHandler = function() {
            $(window).resize(this.resize);
        };

        this.resize = function() {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function() {
                map.relayout();
                map.setCenter(mapOptions.center);
                if(typeof rv === 'object') rv.relayout();
            }, 100);
        };

    	// KakaoMap class 초기화 함수를 호출합니다.
    	this.initialize();
    };

    if(typeof placeInfo.length === 'undefined') window.instofKakaoMap = new KakaoMap(placeInfo);
    else {
        window.instofKakaoMap = [];
        for(var i=0; i<placeInfo.length; i++) {
            window.instofKakaoMap[i] = new KakaoMap(placeInfo[i]);
        }
    }

}(jQuery));
</script>
